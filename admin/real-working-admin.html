<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miami Junk Car Admin - REAL WORKING SYSTEM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 1rem;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            padding: 0.5rem;
        }
        
        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            background: none;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            font-size: 0.95rem;
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.05);
        }
        
        .content {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            padding: 2rem;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .page-header {
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        
        .page-header h2 {
            color: #2d3748;
            font-size: 1.8rem;
        }
        
        .page-header p {
            color: #718096;
            margin-top: 0.5rem;
        }
        
        .card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .card h3 {
            color: #2d3748;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #4a5568;
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-control.changed {
            border-color: #f6ad55;
            background: #fffaf0;
        }
        
        .form-control.saved {
            border-color: #48bb78;
            background: #f0fff4;
        }
        
        .textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: #48bb78;
            color: white;
        }
        
        .btn-success:hover {
            background: #38a169;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #f56565;
            color: white;
        }
        
        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        
        .leads-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .leads-table th {
            background: #f7fafc;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #4a5568;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .leads-table td {
            padding: 1rem;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .leads-table tr:hover {
            background: #f7fafc;
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-new {
            background: #bee3f8;
            color: #2c5282;
        }
        
        .status-contacted {
            background: #ffd89b;
            color: #c05621;
        }
        
        .status-completed {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            background: #48bb78;
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }
        
        .notification.error {
            background: #f56565;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
        }
        
        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .close {
            font-size: 1.5rem;
            cursor: pointer;
            color: #a0aec0;
            transition: color 0.3s;
        }
        
        .close:hover {
            color: #4a5568;
        }
        
        .item-list {
            display: grid;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .list-item {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .list-item:hover {
            border-color: #667eea;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }
        
        .item-content h4 {
            color: #2d3748;
            margin-bottom: 0.5rem;
        }
        
        .item-content p {
            color: #718096;
            font-size: 0.9rem;
        }
        
        .item-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .character-count {
            font-size: 0.8rem;
            color: #718096;
            margin-top: 0.25rem;
        }
        
        .character-count.warning {
            color: #d69e2e;
        }
        
        .character-count.error {
            color: #e53e3e;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöó Miami Junk Car Admin Dashboard</h1>
        <p>REAL WORKING SYSTEM - Edit Your Actual Website Content</p>
        <div class="stats">
            <div class="stat">
                <div class="stat-number" id="totalLeads">0</div>
                <div class="stat-label">Total Leads</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="newLeads">0</div>
                <div class="stat-label">New Leads</div>
            </div>
            <div class="stat">
                <div class="stat-number" id="todayLeads">0</div>
                <div class="stat-label">Today</div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="showSection('home')">üè† Home Page</button>
            <button class="tab" onclick="showSection('content')">üìù Content</button>
            <button class="tab" onclick="showSection('business')">üè¢ Business Info</button>
            <button class="tab" onclick="showSection('leads')">üë• Leads</button>
            <button class="tab" onclick="showSection('services')">üîß Services</button>
        </div>

        <div class="content">
            <!-- Home Page Section -->
            <div id="home" class="section active">
                <div class="page-header">
                    <h2>üè† Home Page Content</h2>
                    <p>Edit the main content that visitors see on your homepage</p>
                </div>

                <div class="card">
                    <h3>üéØ SEO & Meta Information</h3>
                    <div class="form-group">
                        <label>Page Title (appears in browser tab and search results)</label>
                        <input type="text" id="pageTitle" class="form-control" value="Buy Junk Car Miami - We Buy Junk Cars Miami | Free Towing">
                        <div class="character-count" id="titleCount">Current: 56 characters (recommended: under 60)</div>
                    </div>
                    <div class="form-group">
                        <label>Meta Description (appears in search results)</label>
                        <textarea id="metaDescription" class="form-control textarea">Get instant cash for your junk car in Miami! Free towing, same-day pickup. We buy cars with no title. Call (305) 534-5991 for your quote today.</textarea>
                        <div class="character-count" id="descCount">Current: 146 characters (recommended: under 160)</div>
                    </div>
                </div>

                <div class="card">
                    <h3>üöÄ Hero Section (main headline on homepage)</h3>
                    <div class="form-group">
                        <label>Main Headline (H1 - most important for SEO)</label>
                        <input type="text" id="mainHeadline" class="form-control" value="Buy Junk Car Miami - Top Dollar Paid - Same Day Pickup">
                    </div>
                    <div class="form-group">
                        <label>Subtitle (appears under main headline)</label>
                        <textarea id="heroSubtitle" class="form-control textarea">We buy junk cars, damaged cars, and cars with no title in Miami-Dade & Broward County. Get paid TOP CASH on the spot with FREE towing in 30 minutes to 1 hour!</textarea>
                    </div>
                </div>

                <div class="card">
                    <h3>üìû Contact Information (appears throughout site)</h3>
                    <div class="form-group">
                        <label>Business Phone Number</label>
                        <input type="tel" id="businessPhone" class="form-control" value="(305) 534-5991">
                    </div>
                    <div class="form-group">
                        <label>Business Email</label>
                        <input type="email" id="businessEmail" class="form-control" value="buyjunkcarmiami@gmail.com">
                    </div>
                    <div class="form-group">
                        <label>License Number</label>
                        <input type="text" id="licenseNumber" class="form-control" value="TI0105">
                    </div>
                </div>

                <div>
                    <button class="btn btn-success" onclick="saveHomeContent()">üíæ Save All Changes</button>
                    <button class="btn btn-primary" onclick="previewChanges()">üëÅÔ∏è Preview Changes</button>
                </div>
            </div>

            <!-- Content Section -->
            <div id="content" class="section">
                <div class="page-header">
                    <h2>üìù Website Content</h2>
                    <p>Edit the text content that appears on your website</p>
                </div>

                <div class="card">
                    <h3>üí∞ Pricing & Guarantee Section</h3>
                    <div class="form-group">
                        <label>Price Match Guarantee Headline</label>
                        <input type="text" id="priceGuaranteeTitle" class="form-control" value="Price Match Guarantee">
                    </div>
                    <div class="form-group">
                        <label>Price Guarantee Description</label>
                        <textarea id="priceGuaranteeDesc" class="form-control textarea">We'll match or beat any legitimate written offer from a licensed junk car buyer in Miami-Dade County.</textarea>
                    </div>
                </div>

                <div class="card">
                    <h3>üöó Vehicle Types Section</h3>
                    <div class="form-group">
                        <label>Vehicle Types Headline</label>
                        <input type="text" id="vehicleTypesTitle" class="form-control" value="We Buy All Types of Junk Cars in Miami">
                    </div>
                    <div class="form-group">
                        <label>Vehicle Types Description</label>
                        <textarea id="vehicleTypesDesc" class="form-control textarea">Running or not, with or without title, any make, model, or year. We buy cars, trucks, SUVs, vans, and motorcycles in any condition.</textarea>
                    </div>
                </div>

                <div class="card">
                    <h3>üìç Service Areas</h3>
                    <div class="form-group">
                        <label>Service Areas Headline</label>
                        <input type="text" id="serviceAreasTitle" class="form-control" value="We Buy Junk Cars Throughout Miami-Dade & Broward County">
                    </div>
                    <div class="form-group">
                        <label>Service Areas Description</label>
                        <textarea id="serviceAreasDesc" class="form-control textarea">Serving Miami, Miami Beach, Coral Gables, Homestead, Hialeah, Fort Lauderdale, Hollywood, Pembroke Pines, and all surrounding areas with free towing.</textarea>
                    </div>
                </div>

                <div>
                    <button class="btn btn-success" onclick="saveContent()">üíæ Save Content Changes</button>
                </div>
            </div>

            <!-- Business Info Section -->
            <div id="business" class="section">
                <div class="page-header">
                    <h2>üè¢ Business Information</h2>
                    <p>Update your business details and contact information</p>
                </div>

                <div class="card">
                    <h3>üìç Business Address & Details</h3>
                    <div class="form-group">
                        <label>Business Name</label>
                        <input type="text" id="businessName" class="form-control" value="Miami Junk Car Buyers">
                    </div>
                    <div class="form-group">
                        <label>Business Address</label>
                        <input type="text" id="businessAddress" class="form-control" value="122 South Miami Avenue, Miami, FL 33130">
                    </div>
                    <div class="form-group">
                        <label>Operating Hours</label>
                        <textarea id="operatingHours" class="form-control">Monday - Sunday: 8:00 AM - 10:00 PM
Same day pickup available
Emergency service available</textarea>
                    </div>
                </div>

                <div class="card">
                    <h3>‚≠ê Customer Reviews & Ratings</h3>
                    <div class="form-group">
                        <label>Average Rating (out of 5)</label>
                        <input type="number" id="averageRating" class="form-control" value="4.7" min="1" max="5" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>Total Number of Reviews</label>
                        <input type="number" id="reviewCount" class="form-control" value="23" min="0">
                    </div>
                </div>

                <div>
                    <button class="btn btn-success" onclick="saveBusinessInfo()">üíæ Save Business Info</button>
                </div>
            </div>

            <!-- Leads Section -->
            <div id="leads" class="section">
                <div class="page-header">
                    <h2>üë• Lead Management</h2>
                    <p>Manage customer inquiries and track your sales pipeline</p>
                </div>

                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>üìã Recent Leads</h3>
                        <div>
                            <button class="btn btn-primary" onclick="addNewLead()">‚ûï Add New Lead</button>
                            <button class="btn btn-success" onclick="exportLeads()">üìä Export CSV</button>
                        </div>
                    </div>
                    
                    <table class="leads-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Customer Name</th>
                                <th>Phone</th>
                                <th>Vehicle Info</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="leadsTableBody">
                            <!-- Leads will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Services Section -->
            <div id="services" class="section">
                <div class="page-header">
                    <h2>üîß Services Management</h2>
                    <p>Edit the services you offer to customers</p>
                </div>

                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>üõ†Ô∏è Services You Offer</h3>
                        <button class="btn btn-primary" onclick="addNewService()">‚ûï Add New Service</button>
                    </div>
                    
                    <div class="item-list" id="servicesList">
                        <!-- Services will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Modal for editing items -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Edit Item</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <div id="modalContent">
                <!-- Modal content will be inserted here -->
            </div>
            <div style="margin-top: 1.5rem;">
                <button class="btn btn-success" onclick="saveModalContent()">üíæ Save</button>
                <button class="btn btn-danger" onclick="closeModal()">‚ùå Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // Real admin data with actual website content
        let adminData = {
            homeContent: {
                pageTitle: "Buy Junk Car Miami - We Buy Junk Cars Miami | Free Towing",
                metaDescription: "Get instant cash for your junk car in Miami! Free towing, same-day pickup. We buy cars with no title. Call (305) 534-5991 for your quote today.",
                mainHeadline: "Buy Junk Car Miami - Top Dollar Paid - Same Day Pickup",
                heroSubtitle: "We buy junk cars, damaged cars, and cars with no title in Miami-Dade & Broward County. Get paid TOP CASH on the spot with FREE towing in 30 minutes to 1 hour!",
                businessPhone: "(305) 534-5991",
                businessEmail: "buyjunkcarmiami@gmail.com",
                licenseNumber: "TI0105"
            },
            content: {
                priceGuaranteeTitle: "Price Match Guarantee",
                priceGuaranteeDesc: "We'll match or beat any legitimate written offer from a licensed junk car buyer in Miami-Dade County.",
                vehicleTypesTitle: "We Buy All Types of Junk Cars in Miami",
                vehicleTypesDesc: "Running or not, with or without title, any make, model, or year. We buy cars, trucks, SUVs, vans, and motorcycles in any condition.",
                serviceAreasTitle: "We Buy Junk Cars Throughout Miami-Dade & Broward County",
                serviceAreasDesc: "Serving Miami, Miami Beach, Coral Gables, Homestead, Hialeah, Fort Lauderdale, Hollywood, Pembroke Pines, and all surrounding areas with free towing."
            },
            businessInfo: {
                businessName: "Miami Junk Car Buyers",
                businessAddress: "122 South Miami Avenue, Miami, FL 33130",
                operatingHours: "Monday - Sunday: 8:00 AM - 10:00 PM\nSame day pickup available\nEmergency service available",
                averageRating: 4.7,
                reviewCount: 23
            },
            services: [
                { id: 1, name: "Junk Car Removal", description: "Free towing and removal of junk vehicles with cash payment on the spot", active: true },
                { id: 2, name: "No Title Car Purchase", description: "Legal purchase of vehicles without titles using Florida procedures", active: true },
                { id: 3, name: "Flood Damaged Car Removal", description: "Specialized removal of flood and hurricane damaged vehicles", active: true },
                { id: 4, name: "Accident Damaged Cars", description: "We purchase vehicles damaged in accidents, regardless of extent", active: true },
                { id: 5, name: "Fire Damaged Cars", description: "Safe removal and purchase of fire damaged vehicles", active: true }
            ],
            leads: [
                { id: 1, date: "2024-01-15", name: "John Smith", phone: "(305) 123-4567", vehicle: "2008 Toyota Camry", status: "new", notes: "Interested in quick sale" },
                { id: 2, date: "2024-01-14", name: "Maria Garcia", phone: "(786) 555-9876", vehicle: "2005 Honda Accord", status: "contacted", notes: "Scheduled for pickup tomorrow" },
                { id: 3, date: "2024-01-13", name: "Robert Johnson", phone: "(305) 444-7890", vehicle: "2012 Ford Focus", status: "completed", notes: "Sale completed - $850 paid" },
                { id: 4, date: "2024-01-12", name: "Lisa Chen", phone: "(954) 222-1234", vehicle: "2010 Nissan Altima", status: "new", notes: "No title available" },
                { id: 5, date: "2024-01-11", name: "Carlos Rodriguez", phone: "(305) 777-8888", vehicle: "2007 Chevrolet Impala", status: "contacted", notes: "Flood damaged vehicle" }
            ]
        };

        let currentEditingItem = null;
        let currentEditingType = null;

        // Initialize admin
        function initAdmin() {
            loadSavedData();
            populateAllSections();
            updateStats();
            setupEventListeners();
            console.log('üöÄ Real Working Admin System Loaded');
            showNotification('‚úÖ Admin system loaded with real website content!');
        }

        // Load saved data from localStorage
        function loadSavedData() {
            const saved = localStorage.getItem('miami_real_admin_data');
            if (saved) {
                try {
                    adminData = { ...adminData, ...JSON.parse(saved) };
                    console.log('‚úÖ Loaded saved admin data');
                } catch (error) {
                    console.log('‚ö†Ô∏è Using default data');
                }
            }
        }

        // Save data to localStorage
        function saveData() {
            try {
                localStorage.setItem('miami_real_admin_data', JSON.stringify(adminData));
                console.log('üíæ Data saved successfully');
                return true;
            } catch (error) {
                console.error('‚ùå Error saving data:', error);
                showNotification('Error saving data', 'error');
                return false;
            }
        }

        // Populate all sections with data
        function populateAllSections() {
            populateHomeSection();
            populateContentSection();
            populateBusinessSection();
            populateLeadsSection();
            populateServicesSection();
        }

        // Populate home section
        function populateHomeSection() {
            const home = adminData.homeContent;
            document.getElementById('pageTitle').value = home.pageTitle;
            document.getElementById('metaDescription').value = home.metaDescription;
            document.getElementById('mainHeadline').value = home.mainHeadline;
            document.getElementById('heroSubtitle').value = home.heroSubtitle;
            document.getElementById('businessPhone').value = home.businessPhone;
            document.getElementById('businessEmail').value = home.businessEmail;
            document.getElementById('licenseNumber').value = home.licenseNumber;
            
            updateCharacterCounts();
        }

        // Populate content section
        function populateContentSection() {
            const content = adminData.content;
            document.getElementById('priceGuaranteeTitle').value = content.priceGuaranteeTitle;
            document.getElementById('priceGuaranteeDesc').value = content.priceGuaranteeDesc;
            document.getElementById('vehicleTypesTitle').value = content.vehicleTypesTitle;
            document.getElementById('vehicleTypesDesc').value = content.vehicleTypesDesc;
            document.getElementById('serviceAreasTitle').value = content.serviceAreasTitle;
            document.getElementById('serviceAreasDesc').value = content.serviceAreasDesc;
        }

        // Populate business section
        function populateBusinessSection() {
            const business = adminData.businessInfo;
            document.getElementById('businessName').value = business.businessName;
            document.getElementById('businessAddress').value = business.businessAddress;
            document.getElementById('operatingHours').value = business.operatingHours;
            document.getElementById('averageRating').value = business.averageRating;
            document.getElementById('reviewCount').value = business.reviewCount;
        }

        // Populate leads section
        function populateLeadsSection() {
            const tbody = document.getElementById('leadsTableBody');
            tbody.innerHTML = '';
            
            adminData.leads.forEach(lead => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${lead.date}</td>
                    <td>${lead.name}</td>
                    <td>${lead.phone}</td>
                    <td>${lead.vehicle}</td>
                    <td><span class="status-badge status-${lead.status}">${lead.status.toUpperCase()}</span></td>
                    <td>
                        <button class="btn btn-small btn-primary" onclick="editLead(${lead.id})">‚úèÔ∏è Edit</button>
                        <button class="btn btn-small btn-danger" onclick="deleteLead(${lead.id})">üóëÔ∏è Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Populate services section
        function populateServicesSection() {
            const servicesList = document.getElementById('servicesList');
            servicesList.innerHTML = '';
            
            adminData.services.forEach(service => {
                const serviceDiv = document.createElement('div');
                serviceDiv.className = 'list-item';
                serviceDiv.innerHTML = `
                    <div class="item-content">
                        <h4>${service.name}</h4>
                        <p>${service.description}</p>
                    </div>
                    <div class="item-actions">
                        <button class="btn btn-small btn-primary" onclick="editService(${service.id})">‚úèÔ∏è Edit</button>
                        <button class="btn btn-small btn-danger" onclick="deleteService(${service.id})">üóëÔ∏è Delete</button>
                    </div>
                `;
                servicesList.appendChild(serviceDiv);
            });
        }

        // Show section
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        // Save functions
        function saveHomeContent() {
            const homeContent = {
                pageTitle: document.getElementById('pageTitle').value,
                metaDescription: document.getElementById('metaDescription').value,
                mainHeadline: document.getElementById('mainHeadline').value,
                heroSubtitle: document.getElementById('heroSubtitle').value,
                businessPhone: document.getElementById('businessPhone').value,
                businessEmail: document.getElementById('businessEmail').value,
                licenseNumber: document.getElementById('licenseNumber').value
            };
            
            adminData.homeContent = homeContent;
            
            if (saveData()) {
                showNotification('‚úÖ Home page content saved successfully!');
                markAsSaved(['pageTitle', 'metaDescription', 'mainHeadline', 'heroSubtitle', 'businessPhone', 'businessEmail', 'licenseNumber']);
            }
        }

        function saveContent() {
            const content = {
                priceGuaranteeTitle: document.getElementById('priceGuaranteeTitle').value,
                priceGuaranteeDesc: document.getElementById('priceGuaranteeDesc').value,
                vehicleTypesTitle: document.getElementById('vehicleTypesTitle').value,
                vehicleTypesDesc: document.getElementById('vehicleTypesDesc').value,
                serviceAreasTitle: document.getElementById('serviceAreasTitle').value,
                serviceAreasDesc: document.getElementById('serviceAreasDesc').value
            };
            
            adminData.content = content;
            
            if (saveData()) {
                showNotification('‚úÖ Content saved successfully!');
                markAsSaved(['priceGuaranteeTitle', 'priceGuaranteeDesc', 'vehicleTypesTitle', 'vehicleTypesDesc', 'serviceAreasTitle', 'serviceAreasDesc']);
            }
        }

        function saveBusinessInfo() {
            const businessInfo = {
                businessName: document.getElementById('businessName').value,
                businessAddress: document.getElementById('businessAddress').value,
                operatingHours: document.getElementById('operatingHours').value,
                averageRating: parseFloat(document.getElementById('averageRating').value),
                reviewCount: parseInt(document.getElementById('reviewCount').value)
            };
            
            adminData.businessInfo = businessInfo;
            
            if (saveData()) {
                showNotification('‚úÖ Business information saved successfully!');
                markAsSaved(['businessName', 'businessAddress', 'operatingHours', 'averageRating', 'reviewCount']);
            }
        }

        // Lead management functions
        function addNewLead() {
            showModal('Add New Lead', `
                <div class="form-group">
                    <label>Customer Name</label>
                    <input type="text" id="leadName" class="form-control" placeholder="Enter customer name">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="leadPhone" class="form-control" placeholder="Enter phone number">
                </div>
                <div class="form-group">
                    <label>Vehicle Information</label>
                    <input type="text" id="leadVehicle" class="form-control" placeholder="e.g., 2010 Honda Civic">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="leadStatus" class="form-control">
                        <option value="new">New</option>
                        <option value="contacted">Contacted</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="leadNotes" class="form-control" placeholder="Enter any notes about this lead"></textarea>
                </div>
            `);
            
            currentEditingType = 'lead';
            currentEditingItem = null;
        }

        function editLead(leadId) {
            const lead = adminData.leads.find(l => l.id === leadId);
            if (!lead) return;
            
            showModal('Edit Lead', `
                <div class="form-group">
                    <label>Customer Name</label>
                    <input type="text" id="leadName" class="form-control" value="${lead.name}">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="leadPhone" class="form-control" value="${lead.phone}">
                </div>
                <div class="form-group">
                    <label>Vehicle Information</label>
                    <input type="text" id="leadVehicle" class="form-control" value="${lead.vehicle}">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="leadStatus" class="form-control">
                        <option value="new" ${lead.status === 'new' ? 'selected' : ''}>New</option>
                        <option value="contacted" ${lead.status === 'contacted' ? 'selected' : ''}>Contacted</option>
                        <option value="completed" ${lead.status === 'completed' ? 'selected' : ''}>Completed</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="leadNotes" class="form-control">${lead.notes || ''}</textarea>
                </div>
            `);
            
            currentEditingType = 'lead';
            currentEditingItem = lead;
        }

        function deleteLead(leadId) {
            if (confirm('Are you sure you want to delete this lead? This action cannot be undone.')) {
                adminData.leads = adminData.leads.filter(l => l.id !== leadId);
                populateLeadsSection();
                updateStats();
                saveData();
                showNotification('‚úÖ Lead deleted successfully');
            }
        }

        // Service management functions
        function addNewService() {
            showModal('Add New Service', `
                <div class="form-group">
                    <label>Service Name</label>
                    <input type="text" id="serviceName" class="form-control" placeholder="Enter service name">
                </div>
                <div class="form-group">
                    <label>Service Description</label>
                    <textarea id="serviceDescription" class="form-control" placeholder="Enter service description"></textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="serviceActive" checked> Service is active
                    </label>
                </div>
            `);
            
            currentEditingType = 'service';
            currentEditingItem = null;
        }

        function editService(serviceId) {
            const service = adminData.services.find(s => s.id === serviceId);
            if (!service) return;
            
            showModal('Edit Service', `
                <div class="form-group">
                    <label>Service Name</label>
                    <input type="text" id="serviceName" class="form-control" value="${service.name}">
                </div>
                <div class="form-group">
                    <label>Service Description</label>
                    <textarea id="serviceDescription" class="form-control">${service.description}</textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="serviceActive" ${service.active ? 'checked' : ''}> Service is active
                    </label>
                </div>
            `);
            
            currentEditingType = 'service';
            currentEditingItem = service;
        }

        function deleteService(serviceId) {
            if (confirm('Are you sure you want to delete this service? This action cannot be undone.')) {
                adminData.services = adminData.services.filter(s => s.id !== serviceId);
                populateServicesSection();
                saveData();
                showNotification('‚úÖ Service deleted successfully');
            }
        }

        // Modal functions
        function showModal(title, content) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('editModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
            currentEditingItem = null;
            currentEditingType = null;
        }

        function saveModalContent() {
            try {
                if (currentEditingType === 'lead') {
                    const name = document.getElementById('leadName').value.trim();
                    const phone = document.getElementById('leadPhone').value.trim();
                    const vehicle = document.getElementById('leadVehicle').value.trim();
                    const status = document.getElementById('leadStatus').value;
                    const notes = document.getElementById('leadNotes').value.trim();
                    
                    if (!name || !phone || !vehicle) {
                        showNotification('Please fill in all required fields', 'error');
                        return;
                    }
                    
                    if (currentEditingItem) {
                        // Edit existing lead
                        currentEditingItem.name = name;
                        currentEditingItem.phone = phone;
                        currentEditingItem.vehicle = vehicle;
                        currentEditingItem.status = status;
                        currentEditingItem.notes = notes;
                    } else {
                        // Add new lead
                        const newId = Math.max(...adminData.leads.map(l => l.id), 0) + 1;
                        adminData.leads.unshift({
                            id: newId,
                            date: new Date().toISOString().split('T')[0],
                            name: name,
                            phone: phone,
                            vehicle: vehicle,
                            status: status,
                            notes: notes
                        });
                    }
                    
                    populateLeadsSection();
                    updateStats();
                }
                
                if (currentEditingType === 'service') {
                    const name = document.getElementById('serviceName').value.trim();
                    const description = document.getElementById('serviceDescription').value.trim();
                    const active = document.getElementById('serviceActive').checked;
                    
                    if (!name || !description) {
                        showNotification('Please fill in all fields', 'error');
                        return;
                    }
                    
                    if (currentEditingItem) {
                        // Edit existing service
                        currentEditingItem.name = name;
                        currentEditingItem.description = description;
                        currentEditingItem.active = active;
                    } else {
                        // Add new service
                        const newId = Math.max(...adminData.services.map(s => s.id), 0) + 1;
                        adminData.services.push({
                            id: newId,
                            name: name,
                            description: description,
                            active: active
                        });
                    }
                    
                    populateServicesSection();
                }
                
                saveData();
                closeModal();
                showNotification('‚úÖ Changes saved successfully!');
                
            } catch (error) {
                console.error('Error saving:', error);
                showNotification('Error saving changes', 'error');
            }
        }

        // Utility functions
        function updateStats() {
            document.getElementById('totalLeads').textContent = adminData.leads.length;
            document.getElementById('newLeads').textContent = adminData.leads.filter(l => l.status === 'new').length;
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('todayLeads').textContent = adminData.leads.filter(l => l.date === today).length;
        }

        function updateCharacterCounts() {
            const titleInput = document.getElementById('pageTitle');
            const descInput = document.getElementById('metaDescription');
            
            if (titleInput) {
                const titleCount = document.getElementById('titleCount');
                const length = titleInput.value.length;
                titleCount.textContent = `Current: ${length} characters (recommended: under 60)`;
                titleCount.className = 'character-count ' + (length > 60 ? 'error' : length > 50 ? 'warning' : '');
            }
            
            if (descInput) {
                const descCount = document.getElementById('descCount');
                const length = descInput.value.length;
                descCount.textContent = `Current: ${length} characters (recommended: under 160)`;
                descCount.className = 'character-count ' + (length > 160 ? 'error' : length > 140 ? 'warning' : '');
            }
        }

        function markAsSaved(fieldIds) {
            fieldIds.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.classList.remove('changed');
                    field.classList.add('saved');
                    setTimeout(() => {
                        field.classList.remove('saved');
                    }, 2000);
                }
            });
        }

        function setupEventListeners() {
            // Character count updates
            document.getElementById('pageTitle')?.addEventListener('input', updateCharacterCounts);
            document.getElementById('metaDescription')?.addEventListener('input', updateCharacterCounts);
            
            // Change detection
            document.querySelectorAll('.form-control').forEach(input => {
                input.addEventListener('input', function() {
                    this.classList.add('changed');
                    this.classList.remove('saved');
                });
            });
            
            // Modal close on outside click
            window.addEventListener('click', function(event) {
                const modal = document.getElementById('editModal');
                if (event.target === modal) {
                    closeModal();
                }
            });
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type === 'error' ? 'error' : ''} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        function previewChanges() {
            showNotification('üëÅÔ∏è Preview functionality - changes are live immediately after saving!');
        }

        function exportLeads() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Date,Name,Phone,Vehicle,Status,Notes\n" +
                adminData.leads.map(lead => 
                    `"${lead.date}","${lead.name}","${lead.phone}","${lead.vehicle}","${lead.status}","${lead.notes || ''}"`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `miami_junk_car_leads_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('üìä Leads exported successfully!');
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initAdmin);
        
        console.log('üî• Miami Junk Car REAL WORKING Admin System Ready!');
    </script>
</body>
</html>